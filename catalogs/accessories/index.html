<!DOCTYPE html>
<html style="overflow-x: hidden;">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
	<link rel="icon" type="icon" href="https://obuvashka23.ru/img/logoObuvashkaWeb.png">
	<title>Аксессуары | Обувашка</title>
	<link rel="stylesheet" type="text/css" href="../../css/style.css">
	<link rel="stylesheet" type="text/css" href="../../css/styleModal.css">
	<link rel="stylesheet" type="text/css" href="../../css/fontstyle.css">
	<link rel="stylesheet" href="../../css/chief-slider-with-prefixes.min.css">
	<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
	<script src="../../resources/components/index.js"></script>

</head>
<body>
	<header class="header">
		<script>
			showHeader();
		</script>
	</header>
<main>
	<style>
	
		.priceDiv button{
			width: 85px;
    height: 30px;
    border-radius: 5px;
    background-color: #fff;
    margin-bottom: 3%;
    margin-right: 3%;
		}
		.leftFilter select{
			width: 100%;
    		height: 27px;
    		border-color: #fff;
    		border-radius: 5px;
    		margin-top: 3%;
    		font-size: 95%;
    		cursor: pointer;
		}
.leftPanelMobile{
	height: 100%;
}
@media only screen and (max-width: 530px){
	.rightPanel label {
    font-size: 45pt;
}
}

@media only screen and (max-width: 610px){
	.rightPanel p {
    font-size: 12pt;
}
}
@media only screen and (max-width: 530px){
	.buttonPanel button {
    width: 85px;
    font-size: 8pt;
    padding: 0;
    height: 25px;
}
}
@media only screen and (max-width: 767px){
	.leftPanelMobile button {
    height: 30px;
    /* font-size: 14pt; */
    font-weight: 700;
}
}
/* Стили для подложки */

.overlay {
   
   /* Скрываем подложку  */
   opacity: 0;
   visibility: hidden;
   
   position: fixed;
   top: 0;
   left: 0;
   width: 100%;
   height: 100%;
   background-color: rgba(0, 0, 0, .5);
   z-index: 20;
   transition: .3s all;
}
	</style>
				<label class="label-main" style="">
					АКСЕССУАРЫ
				</label>
				<p class="p-main">ВСЕ ЧТО НЕОБХОДИМО ДЛЯ РЕБЕНКА</p>
	<div class="content">
		<div class="leftPanelMobile">
				<button class="openFilter" style="margin-right: 0;">ФИЛЬТРЫ</button>
			</div>
				<div class="leftPanel" id="ltPl">
					<div  style="position: sticky; top: 0;">
						<div style="display: flex;">
							<div class="leftFilter" style="margin-top:5%;">
					<h1>ФИЛЬТРЫ</h1>
					<div class="priceDiv" style="margin-top:7%;">
						<h2>Цена</h2>
						<script>
						function byPrice(byInt){
							let priceUp = document.getElementById("priceUp");
							priceUp.value = byInt;
							update();
						}
					</script>
						<div style="display: flex;">
							<input type="text"  id="priceUp" value="1" onchange="update()" placeholder="От" style="border-radius: 5px 0px 0px 5px;">
						<input type="text" id="priceDown" value="5000" placeholder="До" onchange="update()" style="border-radius: 0px 5px 5px 0px;">
						</div>
						
						<div style="margin-top:3%;display: flex;">
							<button onclick="byPrice(100)">От 100</button>
							<button onclick="byPrice(200)">От 200</button>
							<button onclick="byPrice(300)">От 300</button>
						</div>
					</div>
					
					
<div style="margin-top:10%;">
						<h2>Тип</h2>
						<select id="typeAcc" onchange="update()">
							<option value="">Вся типы</option>
						</select>
					</div>
					
					<div style="margin-top:10%;">
						<h2>Скидки</h2>
						<select id="discount" onchange="update()">
							<option value="0">Все скидки</option>
							<option value="1">до 5%</option>
							<option value="2">от 5% до 10%</option>
							<option value="3">от 10% до 20%</option>
							<option value="4">от 20% до 30%</option>
						</select>
					</div>
					<button onclick="clearFilter()" style="background-color: #fff;height: 25px;border-radius: 5px;margin-top: 10%;
					font-style: italic;font-weight: 800;">Сбросить филтры</button>
					<script>
						function clearFilter(){
							
							let typeAccSelecter = document.getElementById('typeAcc');
							let brandSelecter = document.getElementById('brand');
							let discountSelecter = document.getElementById('discount');
							
							byPrice(100);
							typeAccSelecter.value = "";
							brandSelecter.value = "";
							discountSelecter.value = "0";
							update();
						}
					</script>
				</div>
						</div>
				
					</div>				 
			</div>
			<script>
			async function getPriceShoes(){
				let res = await fetch('https://api.obuvashka23.ru/Accessories/accessoriesBorderPrice');
  				let price = await res.json();
  				price.forEach((data) =>{
					let priceUp =	document.getElementById("priceUp");
					let priceDown =	document.getElementById("priceDown");

					priceDown.value = data.maxprice;
					priceUp.value = data.minprice;
  				}); 
				}
				
			</script>
			<div class="rightPanel" id="rgPn">
				<div class="buttonPanel">
					
					<div class="containerPanel">

							<button class="burgerSortBtn" id="burgerSortBtnID">
								<span></span><span></span><span></span>
							</button>

						<div class="buttonPanelSort">
							<div class="buttonPanelFull">
								<button onclick="clickSort(0, 'price')">ДЕШЕВЛЕ</button>
								<button onclick="clickSort(1, 'price')">ДОРОЖЕ</button>
								<button onclick="clickSort(0, 'popularity')">ПОПУЛЯР.</button>
								<button onclick="clickSort(0, 'id')">УМОЛЧАН.</button>
							</div>
						</div>
					</div>
				</div>
				 <div class="mini-cart">
    			</div>
				<div class="products page" id="pr"></div>
				<div class="paginator" style="margin-top: 3%;margin-bottom: 3%;font-size: 155%;display: flex;justify-content: center;align-items: center;"></div>
		</div>
		

<div class="modal" data-modal="1">
   <svg class="modal__cross js-modal-close" id="closeModal" onclick="closeModal()"  viewBox="0 0 24 24"><path d="M23.954 21.03l-9.184-9.095 9.092-9.174-2.832-2.807-9.09 9.179-9.176-9.088-2.81 2.81 9.186 9.105-9.095 9.184 2.81 2.81 9.112-9.192 9.18 9.1z"/></svg>
   <p class="modal__title">Добавить товар в корзину?</p>
   <select id="countProduct">
			<option value="1">1</option>
			<option value="2">2</option>
			<option value="3">3</option>
   </select>
   <div>
   		<button class="modal__cross js-modal-close" id="closeModalAndSave" >Добавить</button>
   	</div>
</div>
<div class="overlay js-overlay-modal"></div>

	</main>
		<script>
		showFooter();
		</script>
		<script>
var main_page;
var div_num;
var cnt;

let lastFunCalled;
let sortType = '';
let sortDiscountsUp = 0;
let sortDiscountsDown = 1;



function discountSort(){
	switch (document.getElementById('discount').value) {
  case "1":
    sortDiscountsUp = 0.0;
    sortDiscountsDown = 0.06;
    break;
  case "2":
    sortDiscountsUp = 0.05;
    sortDiscountsDown = 0.10;
    break;
    case "3":
    sortDiscountsUp = 0.10;
    sortDiscountsDown = 0.20;
    break;
    case "4":
    sortDiscountsUp = 0.20;
    sortDiscountsDown = 0.30;
    break;
    case "0":
    sortDiscountsUp = 0.0;
    sortDiscountsDown = 1;
    break;
    default:
    	sortDiscountsUp = 0.0;
    sortDiscountsDown = 1;
}
}

	let firstProduct = 0; 
	let lastProduct = 12;
	let i = 0;
	let id = "page0";

	function clicToNextPage(){
		i++;
		firstProduct =  (i * 12);
		getApiProduct();

	}
	function clicToOldPage(){
		i--;
		firstProduct =  (i * 12);
		getApiProduct();

	}

	
	async function  getApiType(){
		let option = document.getElementById("typeAcc");
		let res = await fetch('https://api.obuvashka23.ru/Type?typeObject=accessories');
		let type = await res.json();
		if(type != null){
			type.forEach((data) =>{
		option.innerHTML += `<option value="`+data.id+`">`+data.title+`</option>`;
		
		});

	}}
	getApiType();

	function loaded() {
			document.getElementById('pr').innerHTML = `<h1 style="font-family: 'Alegreya Sans', sans-serif;font-style: italic;font-weight: 700;font-size: 200%;">Загрузка товаров...</h1>`;
			document.getElementsByClassName('paginator')[0].style.display = "none";
		}
		let count;
function update() {
	id = "page0";
	firstProduct = 0;
 lastProduct = 12;
	getApiProduct();
}

//   async function getApiProduct() {
// 	loaded();



// 	  let cartBorder = new Map(); 
//   	let count = 0;

// 	dataLoadBorder = JSON.parse(localStorage.getItem('cart'));

// if(dataLoadBorder != null){
// 	for(let value of dataLoadBorder){
// 		cartBorder.set(value[0], value[1]);
//   }
//  }  	
//   	discountSort();
//   	lastFunCalled = arguments.callee.name;
//   		document.getElementById('pr').innerHTML = "";
//   	let res = await fetch('https://api.obuvashka23.ru/Accessories/filter?color=&sizeHead=&typeId='+document.getElementById('typeAcc').value+'&priceUp=0&priceDown=5000&sortField=&sortType='+"&limitRec=12&оffsetRec=" + firstProduct+sortType+'&priceUp='+document.getElementById('priceUp').value+'&priceDown='+document.getElementById('priceDown').value+'&discountUp='+sortDiscountsUp+'&discountDown='+sortDiscountsDown+ "&limitRec=12&оffsetRec=" + firstProduct);
//   	let products = await res.json();
// 	  if (products != null) {
//   	products.forEach((data) =>{
// 		if (count == 0) {
// document.getElementById('pr').innerHTML = "";
// }
//   		count++;
// 		document.getElementById('pr').innerHTML += showProductAccessories(data.title, data.price, 0, 0, count, data.discount, data.id, data.vendorCode, cartBorder.has(data.vendorCode));	
  	
//   	}); }
// 	else{
// 		document.getElementsByClassName('paginator')[0].style.display = "none";
// document.getElementById('pr').innerHTML = `<h1 style="font-family: 'Alegreya Sans', sans-serif;font-style: italic;font-weight: 700;font-size: 200%;">Ничего не найдено</h1>`;
// cnt1 = 0;

// 	}
// 	let cnt1 = 0;
	
	
// 	  var request = new XMLHttpRequest();
// request.open('GET', 'https://api.obuvashka23.ru/Accessories/filter?color=&sizeHead=&typeId='+document.getElementById('typeAcc').value+'&priceUp=0&priceDown=5000&sortField=&sortType='+sortType+'&priceUp='+document.getElementById('priceUp').value+'&priceDown='+document.getElementById('priceDown').value+'&discountUp='+sortDiscountsUp+'&discountDown='+sortDiscountsDown+"&count=1", false);
// request.send(null);
// if (request.status === 200) {
// let arrayResponse = JSON.parse(request.responseText);
// if (arrayResponse != null) {
// 	cnt1 = arrayResponse[0].count;
// }
// }


//   	var counts = cnt1; 
// cnt = 12;
// var cnt_page = Math.ceil(counts / cnt); 

// var paginator = document.querySelector(".paginator");
// var page = "";
// for (var i = 0; i < cnt_page; i++) {
//   page += `<span onclick="pagination(event)"  data-page=` + i * cnt + `  id="page` + i  + `">` + (i + 1) + `</span>`;
// }
// paginator.innerHTML = page;
// tyr();



// if ( window.innerWidth > 966) {
//  	let we = document.getElementById('rgPn').scrollHeight;
//  		let re = document.getElementById('pr').scrollHeight;
//  		let yt =  re;
// 		document.getElementById('ltPl').style.height = yt+"px";
//  }
//  document.getElementsByClassName('paginator')[0].style.display = "flex";

//   }

function loaded() {
document.getElementById('pr').innerHTML = `<h1 style="font-family: 'Alegreya Sans', sans-serif;font-style: italic;font-weight: 700;font-size: 200%;">Загрузка товаров...</h1>`;
document.getElementsByClassName('paginator')[0].style.display = "none";
}

function update() {
id = "page0";
firstProduct = 0;
lastProduct = 12;
getApiProduct();
}
let countNum = 0;
let nextBlockPage = false;
let f = 1;
let uy = true;
async function getApiProduct() {
loaded();


let cartBorder = new Map();
let count = 0;

dataLoadBorder = JSON.parse(localStorage.getItem('cart'));

if (dataLoadBorder != null) {
for (let value of dataLoadBorder) {
cartBorder.set(value[0], value[1]);
}
}
if (localStorage.getItem("cart") === null) {
	localStorage.setItem('cart', "[]");

  }
discountSort();
lastFunCalled = arguments.callee.name;
let res = await fetch('https://api.obuvashka23.ru/Accessories/filter?color=&sizeHead=&typeId='+document.getElementById('typeAcc').value+'&priceUp=0&priceDown=5000&sortField=&sortType='+"&limitRec=12&оffsetRec=" + firstProduct+sortType+'&priceUp='+document.getElementById('priceUp').value+'&priceDown='+document.getElementById('priceDown').value+'&discountUp='+sortDiscountsUp+'&discountDown='+sortDiscountsDown+ "&limitRec=12&оffsetRec=" + firstProduct);
let products = await res.json();
if (products != null) {

products.forEach((data) => {
if (count == 0) {
document.getElementById('pr').innerHTML = "";
}
count++;
document.getElementById('pr').innerHTML += showProductAccessories(data.title, data.price, 0, 0, count, data.discount, data.id, data.vendorCode, cartBorder.has(data.vendorCode));	


}
);
} else {
document.getElementsByClassName('paginator')[0].style.display = "none";
document.getElementById('pr').innerHTML = `<h1 style="font-family: 'Alegreya Sans', sans-serif;font-style: italic;font-weight: 700;font-size: 200%;">Ничего не найдено</h1>`;
countAllProduct = 0;
}
let countAllProduct = 0;
let request = new XMLHttpRequest();
request.open('GET', 'https://api.obuvashka23.ru/Accessories/filter?color=&sizeHead=&typeId='+document.getElementById('typeAcc').value+'&priceUp=0&priceDown=5000&sortField=&sortType='+sortType+'&priceUp='+document.getElementById('priceUp').value+'&priceDown='+document.getElementById('priceDown').value+'&discountUp='+sortDiscountsUp+'&discountDown='+sortDiscountsDown+"&count=1", false);
request.send(null);

let result = "";
if (request.status === 200) {
let arrayResponse = JSON.parse(request.responseText);
if (arrayResponse != null) {
countAllProduct = arrayResponse[0].count;
}
}


var counts = countAllProduct; //всего 
cnt = 12; //отображение
cnt_page = Math.ceil(counts / cnt);
var paginator = document.querySelector(".paginator");
var page = "";
let lastNum = "";
for (var i = 0; i < cnt_page; i++) {
if(i < 5){
page += `<span onclick="pagination(event, `+f+`)" class="setcolorless"  data-page=` + i * cnt + `  id="page` + i + `">` + (i + 1) + `</span>`;
}else{
lastNum = `<span onclick="nextPages(true)" class="setcolorless" >🠖</span>`;
countNum = i;
}
}

if(!nextBlockPage){
page += lastNum;
paginator.innerHTML = page;
}else{
nextPages(false);
uy = false;
}
document.getElementsByClassName('paginator')[0].style.display = "flex";
tyr();



if (window.innerWidth > 966) {
let we = document.getElementById('rgPn').scrollHeight;
let re = document.getElementById('pr').scrollHeight;
let yt = re;
document.getElementById('ltPl').style.height = yt + "px";
}

}

let ty = true;
function pagination(event, m) {
var e = event || window.event;
var target = e.target;
id = target.id;
var num_ = id.substr(4);
f = m;
ty = false;
clicToSelectPage(num_);
main_page = document.getElementById(id);
main_page.classList.add("paginator_active");
window.scroll({
left: 0,
top: 0,
behavior: 'auto'
});


}
function nextPages(call){
nextBlockPage = true;
if(call){
f++;
}
document.getElementsByClassName('paginator')[0].style.display = "flex";
var paginator = document.querySelector(".paginator");
let countDivision = Math.round(countNum/4) ;//
let count = (countNum + 1) - (countDivision * f);
let nextPages ="";
let page = "";
if((f*5) - 5 > 0){
page += `<span onclick="oldPages()" class="setcolorless" >🠔</span>`;
}
let k = 0;
let allcount =  f*5 + 1;


for (var i = (f*5) - 5; i < allcount; i++) {
if(i <= countNum){
if(i < (f*5) ){
page += `<span onclick="pagination(event, `+f+`)" class="setcolorless"  data-page=` + i * cnt + `  id="page` + i + `">` + (i + 1) + `</span>`;
}else{
nextPages = `<span onclick="nextPages(true)" class="setcolorless" >🠖</span>`;
}
}
}
page += nextPages;
paginator.innerHTML = page;
tyr();
}

function oldPages(){
nextBlockPage = true;
// if(uy){
f--;
// } else{
// 	f++;
// }
uy = true;
var paginator = document.querySelector(".paginator");
var page = "";
let lastNum = "";
let nextPages ="";
if((f*5) - 5 != 0){
page += `<span onclick="oldPages()" class="setcolorless" >🠔</span>`;
}
for (var i = (f*5) - 5; i < f*5 + 1; i++) {
if(i <= countNum){
if(i < (f*5) ){
page += `<span onclick="pagination(event, `+f+`)" class="setcolorless"  data-page=` + i * cnt + `  id="page` + i + `">` + (i + 1) + `</span>`;
}else{
nextPages = `<span onclick="nextPages(true)" class="setcolorless" >🠖</span>`;
}
}
}
page += lastNum;
page += nextPages;
paginator.innerHTML = page;
tyr();
}

function clicToSelectPage(l) {
for (var i = 0; i < cnt_page; i++) {
let colorless = document.getElementById("page" + i);

}
main_page = document.getElementById(id);
main_page.classList.add("paginator");
firstProduct = (l * 12);
getApiProduct();

}

function tyr() {
if (count != 0) {
main_page = document.getElementById(id);
main_page.classList.add("paginator_active");
}
}

  getApiProduct();
  getPriceShoes();
 
    </script>
	<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
	<script>

$(document).ready(function(){
  $(".burgerSortBtn").click(function(){
    $(".buttonPanelSort").slideToggle();
  });
});

$(document).ready(function(){
  $(".openFilter").click(function(){
    $("#ltPl").slideToggle();
  });
});

if ( window.innerWidth < 966) {
	$('.leftPanel').addClass('leftPanelMobile');
$('.leftPanelMobile').removeClass('leftPanel');
$("#ltPl").hide();
}


	</script>

	<script>
		async function cartBorderProduct(NumProduct) {
			NumProduct = NumProduct + 1;
			document.body.innerHTML += '<style>.product:nth-child('+NumProduct+'){border: 3px solid #03A9F4;}</style>';
		}
	</script>

	<script>
   var cart = [];
		
  

  let idWn = 0;
  let nameWn = "";
  let priceWn = 0;
  let size = 0;
  var cart = new Map(); 
  let vendorCodeWn = "";
  let idElementLocal = 0;


    function addToCart(id, name, price, vendorCode, idElement) {
				let div = document.getElementsByClassName("js-open-modal")[idElement];	
					if(div.classList.contains('active') == false) {
							idElementLocal = idElement;
							openModalWindows();

							idWn = id;
  						nameWn = name;
   						priceWn = price;
   						vendorCodeWn = vendorCode;
					}
   	}

	
	
	function openModalWindows(){
		var overlay      = document.querySelector('.js-overlay-modal');
		var modalElem = document.querySelector('.modal[data-modal="1"]');
		
		var close = false;
	
	   modalElem.classList.add('active');
	   overlay.classList.add('active');
	
	   var  closeModal = document.getElementById('closeModal');
	
		return close;
	}

	let dataLoad = {};

		/*var  closeButtons = document.querySelectorAll('.js-modal-close');
		var overlay      = document.querySelector('.js-overlay-modal');
		var  closeModal = document.getElementById('closeModal');
		let choiceSize = document.getElementById('choiceSize');
		let choiceCountProduct = document.getElementById('countProduct');
		countProduct = choiceCountProduct.options[choiceCountProduct.selectedIndex].value;*/

		var  closeButtons = document.querySelectorAll('#closeModal');
		var  closeButtonsAndSave = document.querySelectorAll('#closeModalAndSave');
		var overlay      = document.querySelector('.js-overlay-modal');
		var  closeModal = document.getElementById('closeModal');

		closeButtons.forEach(function(item){
			item.addEventListener('click', function(e) {
			   var parentModal = this.closest('.modal');
			   parentModal.classList.remove('active');
			   overlay.classList.remove('active');
			});
		});

		closeButtonsAndSave.forEach(function(item){
			item.addEventListener('click', function(e) {
			   var parentModal = this.closest('.modal');
			   parentModal.classList.remove('active');
			   overlay.classList.remove('active');
			   closeModalAndAddToCart();
			});
		});

		function closeModalAndAddToCart(){
			var  closeButtons = document.querySelectorAll('#closeModal');
			var overlay      = document.querySelector('.js-overlay-modal');
			var modal      = document.getElementsByClassName('modal')[0];
			let choiceCountProduct = document.getElementById('countProduct');
			let countProduct = choiceCountProduct.options[choiceCountProduct.selectedIndex].value;

			dataLoad = JSON.parse(localStorage.getItem('cart'));
			
			if(dataLoad != null){
				clickAddCart(idElementLocal);
				for(let value of dataLoad){
			 	cart.set(value[0], value[1]);
			  }
			 }
			if (cart.has(vendorCodeWn)==false) {
			
			elements = [];
			
			elements.push(idWn);
			elements.push(nameWn);
			elements.push(priceWn);
			elements.push(0);
			elements.push(countProduct);
			elements.push(1);
			
			 
			cart.set(vendorCodeWn, elements);
			
			}
			else {

			}


			$('.mini-cart').html(showCartElement(cart));

/*****************************/
let cartArray = [];
cartArray = Array.from(cart, ([name, value]) => ({ name, value }));
var cartMap = new Map();
cartMap = Array.from(cartArray, ({name, value}) => ([ name, value ]));
console.log(cart);
localStorage.setItem('cart', JSON.stringify(cartMap));

countProductInCart();


}

countProductInCart();
</script>